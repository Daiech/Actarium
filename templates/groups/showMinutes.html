{% extends "website/layout.html" %}
{% block TITLE %}Actarium - Actas{% endblock %}
{% load gravatartag %}
{%block body%}
<article>
    <header class="row-fluid">
        <h2 class="span12">
        	<a href="/groups/{{group.slug}}">
        	<img src="{{STATIC_PREFIX}}{{minutes.id_group.img_group}}"> {{minutes.id_group.name}}</a>
        	- Acta: {{minutes.code}}</h2>
        <span>Fecha de creaci&oacute;n: {{minutes.date_created}}</span>
    </header>
	<hr>
    <section class="row-fluid">
    	<ul class="pager hoja">
			<li class="previous {%if not prev %}disabled{%endif%}">
				<a href="{%if prev %}/groups/{{group.slug}}/minutes/{{prev.code}}{%else%}#{%endif%}">&larr; Anterior</a>
			</li>
			<li><a href="/groups/{{group.slug}}">Ver listado</a></li>
			<li class="next {%if not next %}disabled{%endif%}">
				<a href="{%if next %}/groups/{{group.slug}}/minutes/{{next.code}}{%else%}#{%endif%}">Siguiente &rarr;</a>
			</li>
		</ul>
    	<article class="minute hoja">
    		<header>
    			<h3>{{group.name}}</h3>
    		</header>
    		<div class="">
    			<strong>Acta No.</strong> {{minutes.code}} de <i>{{minutes.id_extra_minutes.date_start|date:"M d Y"}}</i><hr>
    			<strong>Hora de inicio:</strong> {{minutes.id_extra_minutes.date_start|time}} - 
    			<strong>Hora de finalizaci&oacute;n:</strong> {{minutes.id_extra_minutes.date_end|time}}<hr>
    			<strong>Lugar :</strong> {{minutes.id_extra_minutes.location}}<hr>
    			<div class="list-attendees box">
    				<div class="span6">
    					<strong>Presentes:</strong> 
		    			<ol>
			    			{%for member in m_assistance%}
			    				<li id="user{{member.id_user.id}}">
			    					<img style="width:20px" src="{{member.id_user.email|showgravatar:'20'}}">
			    					{{member.id_user.first_name}} {{member.id_user.last_name}}
			    				</li>
			    			{%endfor%}
			    		</ol>	
    				</div>
    				<div class="span6">
    					<strong>Ausentes:</strong>
		    			<ol>
			    			{%for member in m_no_assistance%}
			    				<li>
			    					<img style="width:20px" src="{{member.id_user.email|showgravatar:'20'}}">
			    					{{member.id_user.first_name}} {{member.id_user.last_name}}
			    				</li>
			    			{%endfor%}
			    		</ol>
    				</div>
    			</div><hr>
    			<strong>Orden del dia:</strong> {{minutes.id_extra_minutes.agenda|safe}}<hr>
    			<strong>Acuerdos :</strong> {{minutes.id_extra_minutes.agreement|safe}}
    			
    		</div>
    		<footer>
    			<p><strong>Los miembros ausentes presentaron excusa de su inasistencia.</strong></p>
    		</footer>
    	</article>
    	<ul class="pager hoja">
			<li class="previous {%if not prev %}disabled{%endif%}">
				<a href="{%if prev %}/groups/{{group.slug}}/minutes/{{prev.code}}{%else%}#{%endif%}">&larr; Anterior</a>
			</li>
			<li><a href="/groups/{{group.slug}}">Ver listado</a></li>
			<li class="next {%if not next %}disabled{%endif%}">
				<a href="{%if next %}/groups/{{group.slug}}/minutes/{{next.code}}{%else%}#{%endif%}">Siguiente &rarr;</a>
			</li>
		</ul>
    </section>
    {% if my_attending %}
    <div id="sign" class="hoja b">
		{% for member in members_signed %}
			{{member.id_user}}<br>
		{% endfor %}
		<a href="#" class="btn btn-success" id="btn-sign" data-minutes="{{minutes.id}}">
			Firmar <span></span></a>
	</div>
	{%endif%}
</article>
{%endblock%}
{% block js %}
<script>
	$(document).on("ready",function(){
		$("#btn-sign").on("click",setSign)
	});
	function callBackSign(data){
		console.log(data)
	}
	function setSign(e){
		e.preventDefault();
		$(this).attr({"disabled":"disabled"})
		var minutes_id = $(this).attr("data-minutes");
		// alert(minutes_id)
		sendAjax(
			"/groups/setSign",
			{"m_id":minutes_id},
			"#btn-sign span",
			callBackSign
			)
	}
</script>
{% endblock %}

{% block style%}
<style>
	.hoja{
		width: 70%;
	}
	#sign{
		margin: 0 auto;
		min-height: 100px;
	}
	.minute{
		border: solid thin #ddd;
		background-color: #fff;
		box-shadow: 8px 8px 6px -6px gray;
		border-radius: 3px;
		/*position: relative;
		top:-55px;*/
	}
	.minute header{
		width: auto;
		margin:0;
		padding: 50px 80px 20px 80px;
	}
	.minute > div{
		padding: 0 80px;
		/*border: solid thin gray;*/
	}
	.minute footer{
		border: none;
		bottom: 0;
		font-size: 14px;
		left: 0;
		margin:0;
		padding: 20px 40px;
		width: auto;
	}
	.pager{
		margin: 5px auto;
		padding: 0;
		position: relative;
		top: 0;
	}
</style>
{%endblock%}

{% extends "organizations/menu.html" %}
{% load i18n has_role %}
{% block TITLE %}{% trans 'Home' %}{% endblock %}
{% has_role "user" "org" "is_admin" as user_is_admin %}
{% block content_menu %}
    <div class="org-profile">
	{% if update %}
    	{% include "organizations/form_org.html" %}
    {% else %}
        <div class="panel panel-default">
            <div class="panel-heading">
                <h3 class="panel-title">{% trans 'Información de organización' %}</h3>
            </div>
            <div class="panel-body">
                <span class="pull-left b"><img src="{{ org.image_path.url_100x100 }}" alt="{{ org.name }}"></span>
                <div class="pull-left org-info">
                    <h3>{{ org.name }}</h3>
                    <p>{{ org.description }}</p>
                    <div class="box org-num-members">
                        <div class="box">
                            <span class="pull-left">{% trans 'Miembros' %}</span>
                            <span class="pull-right">{{ current_members }} {% trans 'de' %} {{ max_members }}</span>
                        </div>
                        <div class="progress">
                          <div class="progress-bar progress-bar-success" role="progressbar" aria-valuenow="40" aria-valuemin="0" aria-valuemax="100" id="org-num-members">
                            <span class="sr-only"></span>
                          </div>
                        </div>
                    </div>
                    {% if user_is_admin %}
                    <p>
                        <a href="{% url 'profile_org' org.slug %}?edit" class="btn">
                            <span class="glyphicon glyphicon-edit"></span> {% trans 'Editar perfil' %}
                        </a>
                        <a href="{% url 'profile_org' org.slug %}?edit" class="btn">
                            <span class="glyphicon glyphicon-edit"></span> {% trans 'Editar perfil' %}
                        </a>
                    </p>
                    {% endif %}
                </div>
            </div>
        </div>

        {% if user_is_admin %}
        <div class="">
            <div class="panel panel-danger">
              <div class="panel-heading">
                <h3 class="panel-title">{% trans 'Eliminar cuenta' %}</h3>
              </div>
              <div class="panel-body">
                <p>{% trans 'Las organizaciones no se pueden eliminar del todo.' %}</p>
                <p>{% trans 'Puedes archivar ésta organización para que desaparezca de tu lista de organizaciones.' %}</p>
                <a href="{% url 'delete_org' org.slug %}" class="btn btn-sm"><span class="glyphicon glyphicon-remove"></span> {% trans 'Archivar organización' %}</a>
              </div>
            </div>
        </div>
        {% endif %}
	{% endif %}
    </div>
{% endblock %}

{% block style_menu %}
<style>
	.org-profile form label{width: 160px;}
	.org-profile .org-info{margin-left: 10px;min-width: 180px;}
    .org-profile .org-info h3{margin-top: 0}
	.org-profile .org-num-members{max-width: 200px}
    #content_menu > div{border:none;}
</style>
{% endblock %}
{% block js_menu %}
    <script>
        $(document).ready(function(){
            $(".org-menu-container #org-profile").addClass("active")
                .find("a > span").addClass("glyphicon glyphicon-chevron-right");
            {% if updated %}
            	setAlertMessage("{% trans 'Información actualizada' %}","{% trans 'La información de su organización ha sido actualizada con éxito' %}");
            {% endif %}
            $("#org-num-members").css({"width": {{ total }} + "%"});
        });
    </script>
{% endblock %}
{% extends "groups/menu.html" %}
{% load gravatartag %}
{% load i18n %}

{% block toolbar_content %}
<ul class="list-unstyled">
    <li>
		<a href="javascript:window.history.back()" class="">
        	<span class="glyphicon glyphicon-arrow-left"></span> {% trans 'Volver' %}
        </a>
    </li>
    <li class="pull-righst">
        <a href="{%if not rel_user.is_secretary%}#{%else%}{% url 'create_minutes' group.slug id_reunion template %}{%endif%}" class="btn-next  btn-submit">
            {% trans 'Siguiente' %} <i class="glyphicon glyphicon-arrow-right icon-white"></i>
        </a>
        <!-- <a href="{%if not rel_user.is_secretary%}#{%else%}/groups/{{group.slug}}/create-minutes{{id_reunion}}/{{template}}{%endif%}" class="btn-submit">
            Siguiente <i class="glyphicon glyphicon-arrow-right icon-white"></i>
        </a> -->
    </li>
</ul>
{% endblock %}

{% block menu_content %}
	<article class="message-box white-box-container">
		<h3>{% trans 'Crear nueva Acta' %}</h3>
		<p><strong>{% trans 'Roles de usuario:' %}</strong> {% trans 'Debes registrar la asistencia de los miembros y definir sus roles antes de crear un acta</p>' %}
		<form class="form-horizontal" enctype="multipart/form-data" method="POST">
			{% csrf_token %}
			<section class="">
				<div class="row mb50">
					<div class="col-md-6">
						<span>{% trans 'Presidente:' %}</span>
						<select id="sel-president">
							<option value="0">{% trans 'Seleccione presidente' %}</option>
						{%for m in members%}
							<option value="{{m.member.id_user.id}}">{{m.member.id_user.first_name}} {{m.member.id_user.last_name}} ({{m.member.id_user.username}})</option>
	                	{%endfor%}
						</select>
						<span class="president-ok hidden"><i class="glyphicon glyphicon-ok"></i></span>
					</div>
					<div class="col-md-6">
						<span>{% trans 'Secretario:' %}</span>
						<select id="sel-secretary">
							<option value="0">{% trans 'Seleccione secretario' %}</option>
						{%for m in members%}
							<option value="{{m.member.id_user.id}}">{{m.member.id_user.first_name}} {{m.member.id_user.last_name}} ({{m.member.id_user.username}})</option>
	                	{%endfor%}
						</select>
						<span class="secretary-ok hidden"><i class="glyphicon glyphicon-ok"></i></span>
					</div>
				</div>
				<table id="table-roles" class="table table-bordered table-hover">
					<tr>
						<th class="td-first">
							<div class="info-title" title="{% trans 'Lista de todos los miembros del grupo' %} '{{group.name}}'">
								{% trans 'Usuarios del grupo' %}
							</div>
						</th>
						<th>
							<div class="info-title" title="{% trans 'Personas que asistieron a la reuni&oacute;n' %}">
								<i class="glyphicon glyphicon-pencil"></i>
								<span class="th-name">{% trans 'Asistentes' %}</span>
							</div>
						</th>
						<th>
							<div class="info-title" title="{% trans 'Personas encargadas de aprobar actas' %}">
								<i class="icon-thumbs-up"></i> 
								<span class="th-name">{% trans 'Aprobador' %}</span>
							</div>
						</th>
						<th>
							<div class="info-title" title="{% trans 'Personas encargadas de firmar las actas' %}">
								<i class="icon-wrench"></i> 
								<span class="th-name">{% trans 'Firmador' %}</span>
							</div>
						</th>
					</tr>
					{%for m in members%}
					<tr {%if m.member.id_user.id == user_selected%}id="user-{{user_selected}}"{%endif%}>
						<td class="td-first">
							<div class="username-info {%if not m.member.is_active%}user-pend-r{%endif%}"
							{%if not m.member.is_active%}title="{{m.member.id_user.username}} a&uacute;n no ha aceptado la invitaci&oacute;n"{%endif%}>
		                        <img style="width:20px" src="{{m.member.id_user.email|showgravatar:'20'}}" alt="{{m.member.id_user}}">
		                        {{m.member.id_user.first_name}} {{m.member.id_user.last_name}}
		                        {%if m.member.id_user == user%}
		                        ({% trans 'yo' %})
		                        {%else%}
		                        ({{m.member.id_user}})
		                        {%endif%}
		                    </div>
						</td>
						<td class="t-a-c">
							<label for="assistant{{m.member.id_user.id}}">
								<input class ="set-role" id="assistant{{m.member.id_user.id}}" type="checkbox" data-role="3" data-role-name="Asistente" data-uid="{{m.member.id_user.id}}" {%if m.rol.is_assistant%}checked{%endif%}>
							</label>
						</td>
						<td class="t-a-c">
							<label for="approver{{m.member.id_user.id}}">
								<input class ="set-role approver" id="approver{{m.member.id_user.id}}" type="checkbox" data-role="2" data-role-name="Aprobador" data-uid="{{m.member.id_user.id}}" {%if m.rol.is_approver%}checked{%endif%}>
							</label>
						</td>
						<td class="t-a-c">
							<label for="signer{{m.member.id_user.id}}">
								<input class ="set-role" id="signer{{m.member.id_user.id}}" type="checkbox" data-role="1" data-role-name="Firmador" data-uid="{{m.member.id_user.id}}" {%if m.rol.is_signer%}checked{%endif%}>
							</label>
						</td>
					</tr>
	                {%endfor%}
				</table>
				<br />
				<label for="show-dni">
					<table>
					<tr>
						<td><input id="show-dni" type="checkbox" {%if show_dni %}checked{%endif%} > &nbsp;&nbsp;</td>
						<td><span id="show-dni-message" >{% trans 'Mostrar el DNI de los encargados de firmar' %}</span></td>
					</tr>
					</table>
				</label>
				
				<br>
				<div id="add-new-member" class="mt20 pull-left">
					<div class="icons-info">
		                <span>{% trans 'Info' %}:</span>
		                <span title="Tiene la responsabilidad de redactar actas"><i class="glyphicon glyphicon-pencil"></i> {% trans 'Asistente' %}</span>
		                <span title="Tiene la responsabilidad de aprobar actas"><i class="icon-thumbs-up"></i> {% trans 'Aprobador' %}</span>
		                <span title="El usuario debe firmar el acta"><i class="icon-wrench"></i> {% trans 'Firmador' %}</span>
		                <span class="user-pend-l"> {% trans 'Usuarios pendientes' %}</span>
					</div>
	            	<div id="show-more-info" class="btn btn-link">
	            		{% trans 'M&aacute;s informaci&oacute;n...' %}
	            	</div>
	            	<div class="more-info">
	            		<div>
	            			<strong><i class="glyphicon glyphicon-pencil"></i> {% trans 'Asistente' %}</strong>: {% trans 'Persona que asisti&oacute; a la reuni&oacute;n. Aparece en el listado de asistentes del Acta.' %}
	            		</div>
	            		<div>
	           				<strong><i class="icon-thumbs-up"></i> {% trans 'Aprobador' %}</strong>: {% trans 'Persona encargada de la aprobaci&oacute;n del Acta. El Acta no ser&aacute; publicada hasta que comisi&oacute;n aprobatoria lo haya aceptado en su totalidad.' %}
	            		</div>
	            		<div>
	            			<strong><i class="icon-wrench"></i> {% trans 'Firmador' %}</strong>: {% trans 'Persona encargada de firmar el Acta. Al final del Acta, solo aparece el listado de firmadores, no de aprobadores.' %}
	            		</div>
	            		<div>
	            			<strong class="user-pend-l">&nbsp;{% trans 'Usuarios pendientes' %}</strong>: {% trans 'Usuarios que no han aceptado la solicitud de ingreso al grupo.' %}
	            		</div>
	            	</div>
	            </div>

			</section>
		</form>
	</article>
{% endblock %}
{%block menu_content_style%}
	<style type="text/css">
		.more-info{font-size: 14px;line-height: 24px;display: none}
		.message-box{width: auto;min-height: 250px}
		.btn-new-minutes{padding-left: 40px;padding-right: 40px;}
		td label{cursor: pointer;margin: 0;padding: 9px;}
		.th-delelte{width: 9%;}
		.td-first{position: relative;}
		div.info-title{text-align: center;font-size: 14px;
			height: 18px;margin: 0;overflow: hidden;padding: 0px;width: 117px;}
		.username-info{padding: 8px;font-size: 13px;}
		.remove-invitation-container{margin-top: 7px;}
		td input[type='checkbox']{margin-top: 0;}
		#table-roles td{padding: 0;}
		#table-roles td.t-a-c{text-align: center;}
		.table{margin-bottom: 0;}
		.form-horizontal label{font-weight: bold;/*margin-top: 10px;*/}
		.list-member-item{border: solid thin #eee;border-bottom: solid thin #dadada;border-radius: 3px;
	        padding: 8px;margin: 2px 0;position: relative; }
	    .list-member-item:hover{border: solid thin #dadada;}
	    .list-member-item > div{/*border: solid thin #dadada;*/width: 80%; }
	    .list-member-item > span{cursor: pointer;top: 0;right: 5px;position: absolute;}
	    /*.span6{border-right: solid thin #dadada;padding: 0 20px;}*/
	    .span6 label{display: inline;}
	    ul#add-member-menu li{margin-bottom: 10px;}
	    .icon-remove{margin: 5px;}
	    ul#search-result{margin-left: 0;}
	    ul#search-result li span{font-size: 13px;margin-left: 13px;color: gray;}
	    .taling{text-align: center;}
	    .list-members span{color: gray;}
	    li a span{/*color:black;*/}
	    li p{color:gray;font-size: 12px;line-height:  1;}
	    /*article{padding-top: 1px;}*/
	    #add-member{position: static;}
	    #newmember{margin: 3px 10px;/*padding: 10px;*/width: 90%;}
	    .dropdown#add-member-menu{text-decoration: none;margin: 5px 20px;}
	    #add-member-menu{/*width:280px;*/}
	    .dropdownmenu  * li{list-style:none;text-decoration: none;}
	    .btnSup{margin-top: 8px;}
	    div > section ul{margin-left:0; }
	    div > section ul li{list-style: none;}
	    .cancel-inv{font-style: italic;color: gray;}
	    .col-md-6{margin-bottom: 10px;}
	</style>
{% endblock %}
{% block menu_content_js %}
	<script type="text/javascript" ><!--
		$(document).ready(function() {
			$("#group-menu-folder").addClass("active");
			$(".icons-info span, .username-info, .info-title").tooltip();
			{% if user_selected%}
			$("#user-{{user_selected}} td").css({"background-color":"#F9F395"})
			{%endif%}
			{% if president %}
			$("#sel-president").val({{president}});
		    $(".president-ok").removeClass("hidden")
			{%endif%}
			{% if secretary%}
			$("#sel-secretary").val({{secretary}})
		    $(".secretary-ok").removeClass("hidden")
			{%endif%}


			$("#show-more-info").on("click", function (e){
				$(".icons-info, .more-info").toggle();
			})

		});
	</script>
{% endblock %}